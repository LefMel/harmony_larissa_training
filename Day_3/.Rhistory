install.packages("devtools")
install.packages("devtools")
devtools::install_github("kpatera/tPRiors")
devtools::install_github("kpatera/tPRiors")
devtools::install_github("kpatera/tPRiors", auth_token = "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")
require(ggmcmc)
load("~/GitHub/harmony_larissa_training/Day_3/Example.mcmc.RData")
fit <- combine.mcmc(Model1.mcmc)
# Combine multiple chains to one
library(runjags)
fit <- combine.mcmc(Model1.mcmc)
fit
library(rjags)
smpls<-coda.samples(model = Model1.mcmc)
smpls<-coda.samples(model = Model1.mcmc,n.iter = 2000)
Model1.mcmc
mcmc(do.call(rbind, Model1.mcmc))
fit<-mcmc(do.call(rbind, Model1.mcmc))
fitbined <- combine.mcmc(Model1.mcmc)
fitbined<-mcmc(do.call(rbind, Model1.mcmc))
traceplot(fitbined)
autocorr.plot(Model1.mcmc)
autocorr.plot(Model1.mcmc)
autocorr.plot(Model1.mcmc)
geweke.plot(Model1.mcmc)
autocorr.plot(fitbined)
geweke.plot(fitbined)
S2<-ggs(fitbined)
ggs_histogram(S2,family = "main") # Histograms (Main)
ggs_histogram(S2) # Histograms (Main)
ggs_density(S2,family = "main") # Density plots for main parameters
ggs_density(S2,family = "sub") # Density plots for study prevalences
ggs_histogram(S2) # Histograms (Main)
ggs_running(S2,family = "main") # Running means plots (Main)
ggs_compare_partial(S2,family = "main") # Partial chain comparison plots (Main)
ggs_autocorrelation(S2,family = "main") # Autocorrelation plots (Main)
ggs_pairs(S2,family = "main", lower = list(continuous = "density")) #crosscorrelation plot
ggs_pairs(S2,lower = list(continuous = "density")) #crosscorrelation plot
ggs_pairs(S2,lower = list(continuous = "density")) #crosscorrelation plot
6/2263
100000*6/2263
39/1186
# (In) Meta-analysis by gender and age subgroups #####
# Subgroup Age ####
LA3D_Age <- data.frame(read_excel("C:/Users/kosta/Dropbox/2. Main Partners/GeorgiopoulosGiorgos/3DLAnormalValues/LA 3D NORMAL VALUES._gg_sf_kp_WASE_updated.xlsx",sheet = 3))
library(readxl)
library(meta)
library(metafor)
LA3D_Age <- data.frame(read_excel("C:/Users/kosta/Dropbox/2. Main Partners/GeorgiopoulosGiorgos/3DLAnormalValues/LA 3D NORMAL VALUES._gg_sf_kp_WASE_updated.xlsx",sheet = 3))
res_Mav_40
res_Mav_40 <- metagen(TE = LA3D_Age$MaxVol_i, seTE = LA3D_Age$MaxVol_i_SD,subset=(LA3D_Age$AgeFilter==1), data=LA3D_Age ,method.tau = "sj")
LA3D_Age
LA3D_Age$AgeFilter
LA3D_Age$MaxVol_i_SD
LA3D_Age$MaxVol_i
res_Mav_40 <- metagen(TE = LA3D_Age$MaxVol_i, seTE = LA3D_Age$MaxVol_i_SD,subset=(LA3D_Age$AgeFilter==1), data=LA3D_Age ,method.tau = "sj")
LA3D_Age$AgeFilter==1
# (In) Meta-analysis by gender and age subgroups #####
# Subgroup Age ####
LA3D_Age <- data.frame(read_excel("C:/Users/kosta/Dropbox/2. Main Partners/GeorgiopoulosGiorgos/3DLAnormalValues/LA 3D NORMAL VALUES._gg_sf_kp_WASE_updated.xlsx",sheet = 3))
res_Mav_40 <- metagen(TE = LA3D_Age$MaxVol_i, seTE = LA3D_Age$MaxVol_i_SD,subset=(LA3D_Age$AgeFilter==1), data=LA3D_Age ,method.tau = "sj")
LA3D_Age
LA3D_Age$AgeFilter==1
# (In) Meta-analysis by gender and age subgroups #####
# Subgroup Age ####
LA3D_Age <- data.frame(read_excel("C:/Users/kosta/Dropbox/2. Main Partners/GeorgiopoulosGiorgos/3DLAnormalValues/LA 3D NORMAL VALUES._gg_sf_kp_WASE_updated.xlsx",sheet = 3))
res_Mav_40 <- metagen(TE = LA3D_Age$MaxVol_i, seTE = LA3D_Age$MaxVol_i_SD,subset=(LA3D_Age$AgeFilter==1), data=LA3D_Age ,method.tau = "sj")
res_Mav_40
res_Mav_4060 <- metagen(TE = LA3D_Age$MaxVol_i, seTE = LA3D_Age$MaxVol_i_SD,subset=(LA3D_Age$AgeFilter==2), data=LA3D_Age ,method.tau = "sj")
res_Mav_60 <- metagen(TE = LA3D_Age$MaxVol_i, seTE = LA3D_Age$MaxVol_i_SD,subset=(LA3D_Age$AgeFilter==3), data=LA3D_Age ,method.tau = "sj")
res_Miv_40 <- metagen(TE = LA3D_Age$MinVol_i, seTE = LA3D_Age$MinVol_i_SD,subset=(LA3D_Age$AgeFilter==1), data=LA3D_Age ,method.tau = "sj")
res_Miv_4060 <- metagen(TE = LA3D_Age$MinVol_i, seTE = LA3D_Age$MinVol_i_SD,subset=(LA3D_Age$AgeFilter==2), data=LA3D_Age ,method.tau = "sj")
res_Miv_60 <- metagen(TE = LA3D_Age$MinVol_i, seTE = LA3D_Age$MinVol_i_SD,subset=(LA3D_Age$AgeFilter==3), data=LA3D_Age ,method.tau = "sj")
res_EF_40 <- metagen(TE = LA3D_Age$EF., seTE = LA3D_Age$EF._SD,subset=(LA3D_Age$AgeFilter==1), data=LA3D_Age ,method.tau = "sj")
res_EF_4060 <- metagen(TE = LA3D_Age$EF., seTE = LA3D_Age$EF._SD,subset=(LA3D_Age$AgeFilter==2), data=LA3D_Age ,method.tau = "sj")
res_EF_60 <- metagen(TE = LA3D_Age$EF., seTE = LA3D_Age$EF._SD,subset=(LA3D_Age$AgeFilter==3), data=LA3D_Age ,method.tau = "sj")
Output_subgroup_Age_fixed<-rbind(
c("Mav","<40",round(c(res_Mav_40$TE.fixed,res_Mav_40$seTE.fixed,res_Mav_40$lower.fixed,res_Mav_40$upper.fixed,res_Mav_40$pval.fixed),3)),
c("Mav","40-60",round(c(res_Mav_4060$TE.fixed,res_Mav_4060$seTE.fixed,res_Mav_4060$lower.fixed,res_Mav_4060$upper.fixed,res_Mav_4060$pval.fixed),3)),
c("Mav",">60",round(c(res_Mav_60$TE.fixed,res_Mav_60$seTE.fixed,res_Mav_60$lower.fixed,res_Mav_60$upper.fixed,res_Mav_60$pval.fixed),3)),
c("Miv","<40",round(c(res_Miv_40$TE.fixed,res_Miv_40$seTE.fixed,res_Miv_40$lower.fixed,res_Miv_40$upper.fixed,res_Miv_40$pval.fixed),3)),
c("Miv","40-60",round(c(res_Miv_4060$TE.fixed,res_Miv_4060$seTE.fixed,res_Miv_4060$lower.fixed,res_Miv_4060$upper.fixed,res_Miv_4060$pval.fixed),3)),
c("Miv",">60",round(c(res_Miv_60$TE.fixed,res_Miv_60$seTE.fixed,res_Miv_60$lower.fixed,res_Miv_60$upper.fixed,res_Miv_60$pval.fixed),3)),
c("EF%","<40",round(c(res_EF_40$TE.fixed,res_EF_40$seTE.fixed,res_EF_40$lower.fixed,res_EF_40$upper.fixed,res_EF_40$pval.fixed),3)),
c("EF%","40-60",round(c(res_EF_4060$TE.fixed,res_EF_4060$seTE.fixed,res_EF_4060$lower.fixed,res_EF_4060$upper.fixed,res_EF_4060$pval.fixed),3)),
c("EF%",">60",round(c(res_EF_60$TE.fixed,res_EF_60$seTE.fixed,res_EF_60$lower.fixed,res_EF_60$upper.fixed,res_EF_60$pval.fixed),3))
)
Output_subgroup_Age_random<-rbind(
c("Mav","<40",round(c(res_Mav_40$TE.random,res_Mav_40$seTE.random,res_Mav_40$lower.random,res_Mav_40$upper.random,res_Mav_40$pval.random),3)),
c("Mav","40-60",round(c(res_Mav_4060$TE.random,res_Mav_4060$seTE.random,res_Mav_4060$lower.random,res_Mav_4060$upper.random,res_Mav_4060$pval.random),3)),
c("Mav",">60",round(c(res_Mav_60$TE.random,res_Mav_60$seTE.random,res_Mav_60$lower.random,res_Mav_60$upper.random,res_Mav_60$pval.random),3)),
c("Miv","<40",round(c(res_Miv_40$TE.random,res_Miv_40$seTE.random,res_Miv_40$lower.random,res_Miv_40$upper.random,res_Miv_40$pval.random),3)),
c("Miv","40-60",round(c(res_Miv_4060$TE.random,res_Miv_4060$seTE.random,res_Miv_4060$lower.random,res_Miv_4060$upper.random,res_Miv_4060$pval.random),3)),
c("Miv",">60",round(c(res_Miv_60$TE.random,res_Miv_60$seTE.random,res_Miv_60$lower.random,res_Miv_60$upper.random,res_Miv_60$pval.random),3)),
c("EF%","<40",round(c(res_EF_40$TE.random,res_EF_40$seTE.random,res_EF_40$lower.random,res_EF_40$upper.random,res_EF_40$pval.random),3)),
c("EF%","40-60",round(c(res_EF_4060$TE.random,res_EF_4060$seTE.random,res_EF_4060$lower.random,res_EF_4060$upper.random,res_EF_4060$pval.random),3)),
c("EF%",">60",round(c(res_EF_60$TE.random,res_EF_60$seTE.random,res_EF_60$lower.random,res_EF_60$upper.random,res_EF_60$pval.random),3))
)
# Subgroup Gender #####
LA3D_Gender <- data.frame(read_excel("C:/Users/kosta/Dropbox/2. Main Partners/GeorgiopoulosGiorgos/3DLAnormalValues/LA 3D NORMAL VALUES.1_gg_sf.xlsx",sheet = 4))
res_Mav_male <- metagen(TE = LA3D_Gender$MaxVol_i, seTE = LA3D_Gender$MaxVol_i_SD, subset=(LA3D_Gender$Gender==1), data=LA3D_Gender ,method.tau = "pm")
res_Mav_female <- metagen(TE = LA3D_Gender$MaxVol_i, seTE = LA3D_Gender$MaxVol_i_SD, subset=(LA3D_Gender$Gender==2), data=LA3D_Gender ,method.tau = "pm")
res_Miv_male <- metagen(TE = LA3D_Gender$MinVol_i, seTE = LA3D_Gender$MinVol_i_SD, subset=(LA3D_Gender$Gender==1), data=LA3D_Gender ,method.tau = "pm")
res_Miv_female <- metagen(TE = LA3D_Gender$MinVol_i, seTE = LA3D_Gender$MinVol_i_SD, subset=(LA3D_Gender$Gender==2), data=LA3D_Gender ,method.tau = "pm")
res_EF_male <- metagen(TE = LA3D_Gender$EF., seTE = LA3D_Gender$EF._SD, subset=(LA3D_Gender$Gender==1), data=LA3D_Gender ,method.tau = "pm")
res_EF_female <- metagen(TE = LA3D_Gender$EF., seTE = LA3D_Gender$EF._SD, subset=(LA3D_Gender$Gender==2), data=LA3D_Gender ,method.tau = "pm")
Output_subgroup_gender_fixed<-rbind(
c("Mav","Male",round(c(res_Mav_male$TE.fixed,res_Mav_male$seTE.fixed,res_Mav_male$lower.fixed,res_Mav_male$upper.fixed,res_Mav_male$pval.fixed),3)),
c("Mav","Female",round(c(res_Mav_female$TE.fixed,res_Mav_female$seTE.fixed,res_Mav_female$lower.fixed,res_Mav_female$upper.fixed,res_Mav_female$pval.fixed),3)),
c("Miv","Male",round(c(res_Miv_male$TE.fixed,res_Miv_male$seTE.fixed,res_Miv_male$lower.fixed,res_Miv_male$upper.fixed,res_Miv_male$pval.fixed),3)),
c("Miv","Female",round(c(res_Miv_female$TE.fixed,res_Miv_female$seTE.fixed,res_Miv_female$lower.fixed,res_Miv_female$upper.fixed,res_Miv_female$pval.fixed),3)),
c("EF%","Male",round(c(res_EF_male$TE.fixed,res_EF_male$seTE.fixed,res_EF_male$lower.fixed,res_EF_male$upper.fixed,res_EF_male$pval.fixed),3)),
c("EF%","Female",round(c(res_EF_female$TE.fixed,res_EF_female$seTE.fixed,res_EF_female$lower.fixed,res_EF_female$upper.fixed,res_EF_female$pval.fixed),3))
)
Output_subgroup_gender_random<-rbind(
c("Mav","Male",round(c(res_Mav_male$TE.random,res_Mav_male$seTE.random,res_Mav_male$lower.random,res_Mav_male$upper.random,res_Mav_male$pval.random),3)),
c("Mav","Female",round(c(res_Mav_female$TE.random,res_Mav_female$seTE.random,res_Mav_female$lower.random,res_Mav_female$upper.random,res_Mav_female$pval.random),3)),
c("Miv","Male",round(c(res_Miv_male$TE.random,res_Miv_male$seTE.random,res_Miv_male$lower.random,res_Miv_male$upper.random,res_Miv_male$pval.random),3)),
c("Miv","Female",round(c(res_Miv_female$TE.random,res_Miv_female$seTE.random,res_Miv_female$lower.random,res_Miv_female$upper.random,res_Miv_female$pval.random),3)),
c("EF%","Male",round(c(res_EF_male$TE.random,res_EF_male$seTE.random,res_EF_male$lower.random,res_EF_male$upper.random,res_EF_male$pval.random),3)),
c("EF%","Female",round(c(res_EF_female$TE.random,res_EF_female$seTE.random,res_EF_female$lower.random,res_EF_female$upper.random,res_EF_female$pval.random),3))
)
# Subgroups by Gender and Age #####
LA3D_Age_Gender <- data.frame(read_excel("C:/Users/kosta/Dropbox/2. Main Partners/GeorgiopoulosGiorgos/3DLAnormalValues/LA 3D NORMAL VALUES.1_gg_sf.xlsx",sheet = 2))
LA3D_Age_Gender$MaxVol_i_SE<-LA3D_Age_Gender$MaxVol_i_SD/sqrt(LA3D_Age_Gender$Number)
LA3D_Age_Gender$MinVol_i_SE<-LA3D_Age_Gender$MinVol_i_SD/sqrt(LA3D_Age_Gender$Number)
LA3D_Age_Gender$EF._SE<-LA3D_Age_Gender$EF._SD/sqrt(LA3D_Age_Gender$Number)
res_Mav_40 <- metagen(TE = LA3D_Age_Gender$MaxVol_i, seTE = LA3D_Age_Gender$MaxVol_i_SE,subset=(LA3D_Age_Gender$AG_Filter==1), data=LA3D_Age_Gender ,method.tau = "sj")
res_Mav_4060 <- metagen(TE = LA3D_Age_Gender$MaxVol_i, seTE = LA3D_Age_Gender$MaxVol_i_SE,subset=(LA3D_Age_Gender$AG_Filter==2), data=LA3D_Age_Gender ,method.tau = "sj")
res_Mav_60 <- metagen(TE = LA3D_Age_Gender$MaxVol_i, seTE = LA3D_Age_Gender$MaxVol_i_SE,subset=(LA3D_Age_Gender$AG_Filter==3), data=LA3D_Age_Gender ,method.tau = "sj")
res_Mav_40f <- metagen(TE = LA3D_Age_Gender$MaxVol_i, seTE = LA3D_Age_Gender$MaxVol_i_SE,subset=(LA3D_Age_Gender$AG_Filter==11), data=LA3D_Age_Gender ,method.tau = "sj")
res_Mav_4060f <- metagen(TE = LA3D_Age_Gender$MaxVol_i, seTE = LA3D_Age_Gender$MaxVol_i_SE,subset=(LA3D_Age_Gender$AG_Filter==22), data=LA3D_Age_Gender ,method.tau = "sj")
res_Mav_60f <- metagen(TE = LA3D_Age_Gender$MaxVol_i, seTE = LA3D_Age_Gender$MaxVol_i_SE,subset=(LA3D_Age_Gender$AG_Filter==33), data=LA3D_Age_Gender ,method.tau = "sj")
res_Miv_40 <- metagen(TE = LA3D_Age_Gender$MinVol_i, seTE = LA3D_Age_Gender$MinVol_i_SE,subset=(LA3D_Age_Gender$AG_Filter==1), data=LA3D_Age_Gender ,method.tau = "sj")
res_Miv_4060 <- metagen(TE = LA3D_Age_Gender$MinVol_i, seTE = LA3D_Age_Gender$MinVol_i_SE,subset=(LA3D_Age_Gender$AG_Filter==2), data=LA3D_Age_Gender ,method.tau = "sj")
res_Miv_60 <- metagen(TE = LA3D_Age_Gender$MinVol_i, seTE = LA3D_Age_Gender$MinVol_i_SE,subset=(LA3D_Age_Gender$AG_Filter==3), data=LA3D_Age_Gender ,method.tau = "sj")
res_Miv_40f <- metagen(TE = LA3D_Age_Gender$MinVol_i, seTE = LA3D_Age_Gender$MinVol_i_SE,subset=(LA3D_Age_Gender$AG_Filter==11), data=LA3D_Age_Gender ,method.tau = "sj")
res_Miv_4060f <- metagen(TE = LA3D_Age_Gender$MinVol_i, seTE = LA3D_Age_Gender$MinVol_i_SE,subset=(LA3D_Age_Gender$AG_Filter==22), data=LA3D_Age_Gender ,method.tau = "sj")
res_Miv_60f <- metagen(TE = LA3D_Age_Gender$MinVol_i, seTE = LA3D_Age_Gender$MinVol_i_SE,subset=(LA3D_Age_Gender$AG_Filter==33), data=LA3D_Age_Gender ,method.tau = "sj")
res_EF_40 <- metagen(TE = LA3D_Age_Gender$EF., seTE = LA3D_Age_Gender$EF._SE,subset=(LA3D_Age_Gender$AG_Filter==1), data=LA3D_Age_Gender ,method.tau = "sj")
res_EF_4060 <- metagen(TE = LA3D_Age_Gender$EF., seTE = LA3D_Age_Gender$EF._SE,subset=(LA3D_Age_Gender$AG_Filter==2), data=LA3D_Age_Gender ,method.tau = "sj")
res_EF_60 <- metagen(TE = LA3D_Age_Gender$EF., seTE = LA3D_Age_Gender$EF._SE,subset=(LA3D_Age_Gender$AG_Filter==3), data=LA3D_Age_Gender ,method.tau = "sj")
res_EF_40f <- metagen(TE = LA3D_Age_Gender$EF., seTE = LA3D_Age_Gender$EF._SE,subset=(LA3D_Age_Gender$AG_Filter==11), data=LA3D_Age_Gender ,method.tau = "sj")
res_EF_4060f <- metagen(TE = LA3D_Age_Gender$EF., seTE = LA3D_Age_Gender$EF._SE,subset=(LA3D_Age_Gender$AG_Filter==22), data=LA3D_Age_Gender ,method.tau = "sj")
res_EF_60f <- metagen(TE = LA3D_Age_Gender$EF., seTE = LA3D_Age_Gender$EF._SE,subset=(LA3D_Age_Gender$AG_Filter==33), data=LA3D_Age_Gender ,method.tau = "sj")
Output_subgroup_Age_Gender_fixed<-rbind(
c("Mav","Male","<40",round(c(res_Mav_40$k,res_Mav_40$TE.fixed,res_Mav_40$seTE.fixed,res_Mav_40$lower.fixed,res_Mav_40$upper.fixed,res_Mav_40$pval.fixed),3)),
c("Mav","Male","40-60",round(c(res_Mav_4060$k,res_Mav_4060$TE.fixed,res_Mav_4060$seTE.fixed,res_Mav_4060$lower.fixed,res_Mav_4060$upper.fixed,res_Mav_4060$pval.fixed),3)),
c("Mav","Male",">60",round(c(res_Mav_60$k,res_Mav_60$TE.fixed,res_Mav_60$seTE.fixed,res_Mav_60$lower.fixed,res_Mav_60$upper.fixed,res_Mav_60$pval.fixed),3)),
c("Mav","Female","<40",round(c(res_Mav_40f$k,res_Mav_40f$TE.fixed,res_Mav_40f$seTE.fixed,res_Mav_40f$lower.fixed,res_Mav_40f$upper.fixed,res_Mav_40f$pval.fixed),3)),
c("Mav","Female","40-60",round(c(res_Mav_4060f$k,res_Mav_4060f$TE.fixed,res_Mav_4060f$seTE.fixed,res_Mav_4060f$lower.fixed,res_Mav_4060f$upper.fixed,res_Mav_4060f$pval.fixed),3)),
c("Mav","Female",">60",round(c(res_Mav_60f$k,res_Mav_60f$TE.fixed,res_Mav_60f$seTE.fixed,res_Mav_60f$lower.fixed,res_Mav_60f$upper.fixed,res_Mav_60f$pval.fixed),3)),
c("Miv","Male","<40",round(c(res_Miv_40$k,res_Miv_40$TE.fixed,res_Miv_40$seTE.fixed,res_Miv_40$lower.fixed,res_Miv_40$upper.fixed,res_Miv_40$pval.fixed),3)),
c("Miv","Male","40-60",round(c(res_Miv_4060$k,res_Miv_4060$TE.fixed,res_Miv_4060$seTE.fixed,res_Miv_4060$lower.fixed,res_Miv_4060$upper.fixed,res_Miv_4060$pval.fixed),3)),
c("Miv","Male",">60",round(c(res_Miv_60$k,res_Miv_60$TE.fixed,res_Miv_60$seTE.fixed,res_Miv_60$lower.fixed,res_Miv_60$upper.fixed,res_Miv_60$pval.fixed),3)),
c("Miv","Female","<40",round(c(res_Miv_40f$k,res_Miv_40f$TE.fixed,res_Miv_40f$seTE.fixed,res_Miv_40f$lower.fixed,res_Miv_40f$upper.fixed,res_Miv_40f$pval.fixed),3)),
c("Miv","Female","40-60",round(c(res_Miv_4060f$k,res_Miv_4060f$TE.fixed,res_Miv_4060f$seTE.fixed,res_Miv_4060f$lower.fixed,res_Miv_4060f$upper.fixed,res_Miv_4060f$pval.fixed),3)),
c("Miv","Female",">60",round(c(res_Miv_60f$k,res_Miv_60f$TE.fixed,res_Miv_60f$seTE.fixed,res_Miv_60f$lower.fixed,res_Miv_60f$upper.fixed,res_Miv_60f$pval.fixed),3)),
c("EF","Male","<40",round(c(res_EF_40$k,res_EF_40$TE.fixed,res_EF_40$seTE.fixed,res_EF_40$lower.fixed,res_EF_40$upper.fixed,res_EF_40$pval.fixed),3)),
c("EF","Male","40-60",round(c(res_EF_4060$k,res_EF_4060$TE.fixed,res_EF_4060$seTE.fixed,res_EF_4060$lower.fixed,res_EF_4060$upper.fixed,res_EF_4060$pval.fixed),3)),
c("EF","Male",">60",round(c(res_EF_60$k,res_EF_60$TE.fixed,res_EF_60$seTE.fixed,res_EF_60$lower.fixed,res_EF_60$upper.fixed,res_EF_60$pval.fixed),3)),
c("EF","Female","<40",round(c(res_EF_40f$k,res_EF_40f$TE.fixed,res_EF_40f$seTE.fixed,res_EF_40f$lower.fixed,res_EF_40f$upper.fixed,res_EF_40f$pval.fixed),3)),
c("EF","Female","40-60",round(c(res_EF_4060f$k,res_EF_4060f$TE.fixed,res_EF_4060f$seTE.fixed,res_EF_4060f$lower.fixed,res_EF_4060f$upper.fixed,res_EF_4060f$pval.fixed),3)),
c("EF","Female",">60",round(c(res_EF_60f$k,res_EF_60f$TE.fixed,res_EF_60f$seTE.fixed,res_EF_60f$lower.fixed,res_EF_60f$upper.fixed,res_EF_60f$pval.fixed),3))
)
Output_subgroup_Age_Gender_random<-rbind(
c("Mav","Male","<40",round(c(res_Mav_40$k,res_Mav_40$TE.random,res_Mav_40$seTE.random,res_Mav_40$lower.random,res_Mav_40$upper.random,res_Mav_40$pval.random),3)),
c("Mav","Male","40-60",round(c(res_Mav_4060$k,res_Mav_4060$TE.random,res_Mav_4060$seTE.random,res_Mav_4060$lower.random,res_Mav_4060$upper.random,res_Mav_4060$pval.random),3)),
c("Mav","Male",">60",round(c(res_Mav_60$k,res_Mav_60$TE.random,res_Mav_60$seTE.random,res_Mav_60$lower.random,res_Mav_60$upper.random,res_Mav_60$pval.random),3)),
c("Mav","Female","<40",round(c(res_Mav_40f$k,res_Mav_40f$TE.random,res_Mav_40f$seTE.random,res_Mav_40f$lower.random,res_Mav_40f$upper.random,res_Mav_40f$pval.random),3)),
c("Mav","Female","40-60",round(c(res_Mav_4060f$k,res_Mav_4060f$TE.random,res_Mav_4060f$seTE.random,res_Mav_4060f$lower.random,res_Mav_4060f$upper.random,res_Mav_4060f$pval.random),3)),
c("Mav","Female",">60",round(c(res_Mav_60f$k,res_Mav_60f$TE.random,res_Mav_60f$seTE.random,res_Mav_60f$lower.random,res_Mav_60f$upper.random,res_Mav_60f$pval.random),3)),
c("Miv","Male","<40",round(c(res_Miv_40$k,res_Miv_40$TE.random,res_Miv_40$seTE.random,res_Miv_40$lower.random,res_Miv_40$upper.random,res_Miv_40$pval.random),3)),
c("Miv","Male","40-60",round(c(res_Miv_4060$k,res_Miv_4060$TE.random,res_Miv_4060$seTE.random,res_Miv_4060$lower.random,res_Miv_4060$upper.random,res_Miv_4060$pval.random),3)),
c("Miv","Male",">60",round(c(res_Miv_60$k,res_Miv_60$TE.random,res_Miv_60$seTE.random,res_Miv_60$lower.random,res_Miv_60$upper.random,res_Miv_60$pval.random),3)),
c("Miv","Female","<40",round(c(res_Miv_40f$k,res_Miv_40f$TE.random,res_Miv_40f$seTE.random,res_Miv_40f$lower.random,res_Miv_40f$upper.random,res_Miv_40f$pval.random),3)),
c("Miv","Female","40-60",round(c(res_Miv_4060f$k,res_Miv_4060f$TE.random,res_Miv_4060f$seTE.random,res_Miv_4060f$lower.random,res_Miv_4060f$upper.random,res_Miv_4060f$pval.random),3)),
c("Miv","Female",">60",round(c(res_Miv_60f$k,res_Miv_60f$TE.random,res_Miv_60f$seTE.random,res_Miv_60f$lower.random,res_Miv_60f$upper.random,res_Miv_60f$pval.random),3)),
c("EF","Male","<40",round(c(res_EF_40$k,res_EF_40$TE.random,res_EF_40$seTE.random,res_EF_40$lower.random,res_EF_40$upper.random,res_EF_40$pval.random),3)),
c("EF","Male","40-60",round(c(res_EF_4060$k,res_EF_4060$TE.random,res_EF_4060$seTE.random,res_EF_4060$lower.random,res_EF_4060$upper.random,res_EF_4060$pval.random),3)),
c("EF","Male",">60",round(c(res_EF_60$k,res_EF_60$TE.random,res_EF_60$seTE.random,res_EF_60$lower.random,res_EF_60$upper.random,res_EF_60$pval.random),3)),
c("EF","Female","<40",round(c(res_EF_40f$k,res_EF_40f$TE.random,res_EF_40f$seTE.random,res_EF_40f$lower.random,res_EF_40f$upper.random,res_EF_40f$pval.random),3)),
c("EF","Female","40-60",round(c(res_EF_4060f$k,res_EF_4060f$TE.random,res_EF_4060f$seTE.random,res_EF_4060f$lower.random,res_EF_4060f$upper.random,res_EF_4060f$pval.random),3)),
c("EF","Female",">60",round(c(res_EF_60f$k,res_EF_60f$TE.random,res_EF_60f$seTE.random,res_EF_60f$lower.random,res_EF_60f$upper.random,res_EF_60f$pval.random),3))
)
Output_subgroup_Age_Gender_fixed<-as.data.frame(Output_subgroup_Age_Gender_fixed)
Output_subgroup_Age_Gender_random<-as.data.frame(Output_subgroup_Age_Gender_random)
colnames(Output_subgroup_Age_Gender_fixed)<-colnames(Output_subgroup_Age_Gender_random)<-c("Measure","Gender","Age","Studies","Estimate","St. Error","LL","UL","p-value")
write.csv(x = Output_subgroup_Age_Gender_fixed,file = "C:/Users/kosta/Dropbox/2. Main Partners/GeorgiopoulosGiorgos/3DLAnormalValues/Subgroups_fixed_upd4.csv")
write.csv(x = Output_subgroup_Age_Gender_random,file = "C:/Users/kosta/Dropbox/2. Main Partners/GeorgiopoulosGiorgos/3DLAnormalValues/Subgroups_random_upd4.csv")
resMav
LA_3D_NORMAL_VALUES_1<-LA3D <- data.frame(read_excel("C:/Users/kosta/Dropbox/2. Main Partners/GeorgiopoulosGiorgos/3DLAnormalValues/LA 3D NORMAL VALUES._gg_sf_kp_WASE_updated.xlsx"))
names(LA3D)[2:3]<-c("Study.Year","Year")
LA3D<-LA3D[order(LA3D$Year),]
LA3D$MalePer<-100*LA3D$Males/LA3D$Number
LA3D$MaxVol_i_SE<-LA3D$MaxVol_i_SD/sqrt(LA3D$Number)
LA3D$MinVol_i_SE<-LA3D$MinVol_i_SD/sqrt(LA3D$Number)
LA3D$EF._SE<-LA3D$EF._SD/sqrt(LA3D$Number)
resMav<-metagen(TE = MaxVol_i,seTE = MaxVol_i_SE, studlab = `Study.Year`, data =  LA3D[!is.na(LA3D$MaxVol_i),], method.tau = "pm")
forest(resMav,leftlabs=c("Study, Year","Mean","St. Error"),xlim = c(14,33),
rightlabs=c("","95% limits","Weight"), comb.fixed = F, comb.random = T,ref = 24.43)
resMav
resMav<-metagen(TE = MaxVol_i,seTE = MaxVol_i_SE, studlab = `Study.Year`, data =  LA3D[!is.na(LA3D$MaxVol_i) & LA3D$Study.Year!="Bhambhani, 2017",], method.tau = "pm")
forest(resMav,leftlabs=c("Study, Year","Mean","St. Error"),xlim = c(14,33),prediction = T,
rightlabs=c("","95% limits","Weight"), comb.fixed = F, comb.random = T,ref = 24.43)
resMav<-metagen(TE = MaxVol_i,seTE = MaxVol_i_SE, studlab = `Study.Year`, data =  LA3D[!is.na(LA3D$MaxVol_i),], method.tau = "pm")
forest(resMav,leftlabs=c("Study, Year","Mean","St. Error"),xlim = c(14,33),prediction = T,
rightlabs=c("","95% limits","Weight"), comb.fixed = F, comb.random = T,ref = 24.43)
dev.off()
forest(resMav,leftlabs=c("Study, Year","Mean","St. Error"),xlim = c(14,33),prediction = T,
rightlabs=c("","95% limits","Weight"), comb.fixed = F, comb.random = T,ref = 24.43)
InfAnalysis_Mav<-metainf(resMav,"Random",)
InfAnalysis_Mav
plot(InfAnalysis_Mav)
pdf("MAV_forest_upd4.pdf", width=10, height=5.5)
resMav<-metagen(TE = MaxVol_i,seTE = MaxVol_i_SE, studlab = `Study.Year`, data =  LA3D[!is.na(LA3D$MaxVol_i),], method.tau = "pm")
forest(resMav,leftlabs=c("Study, Year","Mean","St. Error"),xlim = c(14,33),prediction = T,
rightlabs=c("","95% limits","Weight"), comb.fixed = F, comb.random = T,ref = 24.43)
dev.off()
pdf("MIv_forest_upd4.pdf", width=10, height=5.5)
resMiV<-metagen(TE = MinVol_i,seTE = MinVol_i_SE, studlab = `Study.Year`,data =  LA3D[!is.na(LA3D$MinVol_i),], method.tau = "pm")
forest(resMiV,leftlabs=c("Study, Year","Mean","St. Error"), xlim = c(5,17),prediction = T,
rightlabs=c("","95% limits","Weight"), comb.fixed = F, comb.random = T,ref = 10.52)
dev.off()
pdf("EF_forest_upd4.pdf", width=10, height=5.5)
resEF<-metagen(TE = `EF.`,seTE = `EF._SE`, studlab = `Study.Year`,data =  LA3D[!is.na(LA3D$EF.),], method.tau = "pm")
forest(resEF,leftlabs=c("Study, Year","Mean","St. Error"),xlim=c(40,75),prediction = T,
rightlabs=c("","95% limits","Weight"), comb.fixed = F, comb.random = T,ref=58.42)
dev.off()
InfAnalysis_Mav<-metainf(resMav,"Random")
InfAnalysis_Miv<-metainf(resMiV,"Random")
InfAnalysis_EF<-metainf(resEF,"Random")
write.csv(x = InfAnalysis_Mav,file = "InfAnalysis_Mav.csv")
write.csv(x = InfAnalysis_Miv,file = "InfAnalysis_Miv.csv")
write.csv(x = InfAnalysis_EF,file = "InfAnalysis_EF.csv")
getwd()
